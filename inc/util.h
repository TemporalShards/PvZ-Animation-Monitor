/*
 * @Author: TemporalShards
 * @Date: 2025-01-24 21:38:06
 * @Last Modified by: TemporalShards
 * @Description：
 */
#pragma once
#ifndef __UTIL_H__
#define __UTIL_H__
#include <wx/string.h>

#include <Windows.h>
#include <unordered_map>

// 虚拟键码表
static const std::unordered_map<const char*, int> VirtualKeyMap = {
    {"LBUTTON", VK_LBUTTON},
    {"RBUTTON", VK_RBUTTON},
    {"CANCEL", VK_CANCEL},
    {"MBUTTON", VK_MBUTTON},
    {"XBUTTON1", VK_XBUTTON1},
    {"XBUTTON2", VK_XBUTTON2},
    {"BACK", VK_BACK},
    {"TAB", VK_TAB},
    {"CLEAR", VK_CLEAR},
    {"RETURN", VK_RETURN},
    {"SHIFT", VK_SHIFT},
    {"CONTROL", VK_CONTROL},
    {"MENU", VK_MENU},
    {"PAUSE", VK_PAUSE},
    {"CAPITAL", VK_CAPITAL},
    {"KANA", VK_KANA},
    {"HANGEUL", VK_HANGEUL},
    {"HANGUL", VK_HANGUL},
    {"JUNJA", VK_JUNJA},
    {"FINAL", VK_FINAL},
    {"HANJA", VK_HANJA},
    {"KANJI", VK_KANJI},
    {"ESCAPE", VK_ESCAPE},
    {"CONVERT", VK_CONVERT},
    {"NONCONVERT", VK_NONCONVERT},
    {"ACCEPT", VK_ACCEPT},
    {"MODECHANGE", VK_MODECHANGE},
    {"SPACE", VK_SPACE},
    {"PRIOR", VK_PRIOR},
    {"NEXT", VK_NEXT},
    {"END", VK_END},
    {"HOME", VK_HOME},
    {"LEFT", VK_LEFT},
    {"UP", VK_UP},
    {"RIGHT", VK_RIGHT},
    {"DOWN", VK_DOWN},
    {"SELECT", VK_SELECT},
    {"PRINT", VK_PRINT},
    {"EXECUTE", VK_EXECUTE},
    {"SNAPSHOT", VK_SNAPSHOT},
    {"INSERT", VK_INSERT},
    {"DELETE", VK_DELETE},
    {"HELP", VK_HELP},
    {"0", '0'},
    {"1", '1'},
    {"2", '2'},
    {"3", '3'},
    {"4", '4'},
    {"5", '5'},
    {"6", '6'},
    {"7", '7'},
    {"8", '8'},
    {"9", '9'},
    {"A", 'A'},
    {"B", 'B'},
    {"C", 'C'},
    {"D", 'D'},
    {"E", 'E'},
    {"F", 'F'},
    {"G", 'G'},
    {"H", 'H'},
    {"I", 'I'},
    {"J", 'J'},
    {"K", 'K'},
    {"L", 'L'},
    {"M", 'M'},
    {"N", 'N'},
    {"O", 'O'},
    {"P", 'P'},
    {"Q", 'Q'},
    {"R", 'R'},
    {"S", 'S'},
    {"T", 'T'},
    {"U", 'U'},
    {"V", 'V'},
    {"W", 'W'},
    {"X", 'X'},
    {"Y", 'Y'},
    {"Z", 'Z'},
    {"LWIN", VK_LWIN},
    {"RWIN", VK_RWIN},
    {"APPS", VK_APPS},
    {"SLEEP", VK_SLEEP},
    {"NUMPAD0", VK_NUMPAD0},
    {"NUMPAD1", VK_NUMPAD1},
    {"NUMPAD2", VK_NUMPAD2},
    {"NUMPAD3", VK_NUMPAD3},
    {"NUMPAD4", VK_NUMPAD4},
    {"NUMPAD5", VK_NUMPAD5},
    {"NUMPAD6", VK_NUMPAD6},
    {"NUMPAD7", VK_NUMPAD7},
    {"NUMPAD8", VK_NUMPAD8},
    {"NUMPAD9", VK_NUMPAD9},
    {"MULTIPLY", VK_MULTIPLY},
    {"ADD", VK_ADD},
    {"SEPARATOR", VK_SEPARATOR},
    {"SUBTRACT", VK_SUBTRACT},
    {"DECIMAL", VK_DECIMAL},
    {"DIVIDE", VK_DIVIDE},
    {"F1", VK_F1},
    {"F2", VK_F2},
    {"F3", VK_F3},
    {"F4", VK_F4},
    {"F5", VK_F5},
    {"F6", VK_F6},
    {"F7", VK_F7},
    {"F8", VK_F8},
    {"F9", VK_F9},
    {"F10", VK_F10},
    {"F11", VK_F11},
    {"F12", VK_F12},
    {"F13", VK_F13},
    {"F14", VK_F14},
    {"F15", VK_F15},
    {"F16", VK_F16},
    {"F17", VK_F17},
    {"F18", VK_F18},
    {"F19", VK_F19},
    {"F20", VK_F20},
    {"F21", VK_F21},
    {"F22", VK_F22},
    {"F23", VK_F23},
    {"F24", VK_F24},
    {"NUMLOCK", VK_NUMLOCK},
    {"SCROLL", VK_SCROLL},
    {"LSHIFT", VK_LSHIFT},
    {"RSHIFT", VK_RSHIFT},
    {"LCONTROL", VK_LCONTROL},
    {"RCONTROL", VK_RCONTROL},
    {"LMENU", VK_LMENU},
    {"RMENU", VK_RMENU},
    {"BROWSER_BACK", VK_BROWSER_BACK},
    {"BROWSER_FORWARD", VK_BROWSER_FORWARD},
    {"BROWSER_REFRESH", VK_BROWSER_REFRESH},
    {"BROWSER_STOP", VK_BROWSER_STOP},
    {"BROWSER_SEARCH", VK_BROWSER_SEARCH},
    {"BROWSER_FAVORITES", VK_BROWSER_FAVORITES},
    {"BROWSER_HOME", VK_BROWSER_HOME},
    {"VOLUME_MUTE", VK_VOLUME_MUTE},
    {"VOLUME_DOWN", VK_VOLUME_DOWN},
    {"VOLUME_UP", VK_VOLUME_UP},
    {"MEDIA_NEXT_TRACK", VK_MEDIA_NEXT_TRACK},
    {"MEDIA_PREV_TRACK", VK_MEDIA_PREV_TRACK},
    {"MEDIA_STOP", VK_MEDIA_STOP},
    {"MEDIA_PLAY_PAUSE", VK_MEDIA_PLAY_PAUSE},
    {"LAUNCH_MAIL", VK_LAUNCH_MAIL},
    {"LAUNCH_MEDIA_SELECT", VK_LAUNCH_MEDIA_SELECT},
    {"LAUNCH_APP1", VK_LAUNCH_APP1},
    {"LAUNCH_APP2", VK_LAUNCH_APP2},
    {"OEM_1", VK_OEM_1},
    {"OEM_2", VK_OEM_2},
    {"OEM_3", VK_OEM_3},
    {"OEM_4", VK_OEM_4},
    {"OEM_5", VK_OEM_5},
    {"OEM_6", VK_OEM_6},
    {"OEM_7", VK_OEM_7},
    {"OEM_8", VK_OEM_8},
    {"PROCESSKEY", VK_PROCESSKEY},
    {"PACKET", VK_PACKET},
    {"ATTN", VK_ATTN},
    {"CRSEL", VK_CRSEL},
    {"EXSEL", VK_EXSEL},
    {"EREOF", VK_EREOF},
    {"PLAY", VK_PLAY},
    {"ZOOM", VK_ZOOM},
    {"NONAME", VK_NONAME},
    {"PA1", VK_PA1},
    {"OEM_CLEAR", VK_OEM_CLEAR},

    // 兼容旧版的部分按键
    {"BACKSPACE", VK_BACK},
    {"CTRL", VK_CONTROL},
};

// 指定键均被按下时，返回true。
// 取自：https://github.com/qrmd0/AvZLib/tree/main/qrmd/qmLib#avz-qmlib
inline bool GetIsKeysDown(HWND hWnd, const std::vector<int>& keys, bool isRequirePvZActive = true)
{
    if (isRequirePvZActive && GetForegroundWindow() != hWnd)
        return false;

    if (keys.empty())
        return false;

    for (const auto& each : keys) {
        if ((GetAsyncKeyState(each) & 0x8000) == 0)
            return false;
    }
    return true;
}

inline wxString GetWindowTitle(HWND hWnd)
{
    TCHAR title[256];
    if (GetWindowText(hWnd, title, sizeof(title) / sizeof(TCHAR)) > 0)
        return wxString(title);

    return wxEmptyString;
}

static const std::unordered_map<DWORD, const char*> LoopTimeName = {
    {0, "LOOP"},
    {1, "LOOP_FULL_LAST_FRAME"},
    {2, "PLAY_ONCE"},
    {3, "PLAY_ONCE_AND_HOLD"},
    {4, "PLAY_ONCE_FULL_LAST_FRAME"},
    {5, "PLAY_ONCE_FULL_LAST_FRAME_AND_HOLD"},
};

static const std::unordered_map<DWORD, const char*> ReanimationName = {
    {-1, "NULL"},
    {0, "LOADBAR_SPROUT"},
    {1, "LOADBAR_ZOMBIEHEAD"},
    {2, "SODROLL"},
    {3, "FINAL_WAVE"},
    {4, "PEASHOOTER"},
    {5, "WALLNUT"},
    {6, "LILYPAD"},
    {7, "SUNFLOWER"},
    {8, "LAWNMOWER"},
    {9, "READYSETPLANT"},
    {10, "CHERRYBOMB"},
    {11, "SQUASH"},
    {12, "DOOMSHROOM"},
    {13, "SNOWPEA"},
    {14, "REPEATER"},
    {15, "SUNSHROOM"},
    {16, "TALLNUT"},
    {17, "FUMESHROOM"},
    {18, "PUFFSHROOM"},
    {19, "HYPNOSHROOM"},
    {20, "CHOMPER"},
    {21, "ZOMBIE"},
    {22, "SUN"},
    {23, "POTATOMINE"},
    {24, "SPIKEWEED"},
    {25, "SPIKEROCK"},
    {26, "THREEPEATER"},
    {27, "MARIGOLD"},
    {28, "ICESHROOM"},
    {29, "ZOMBIE_FOOTBALL"},
    {30, "ZOMBIE_NEWSPAPER"},
    {31, "ZOMBIE_ZAMBONI"},
    {32, "SPLASH"},
    {33, "JALAPENO"},
    {34, "JALAPENO_FIRE"},
    {35, "COIN_SILVER"},
    {36, "ZOMBIE_CHARRED"},
    {37, "ZOMBIE_CHARRED_IMP"},
    {38, "ZOMBIE_CHARRED_DIGGER"},
    {39, "ZOMBIE_CHARRED_ZAMBONI"},
    {40, "ZOMBIE_CHARRED_CATAPULT"},
    {41, "ZOMBIE_CHARRED_GARGANTUAR"},
    {42, "SCRAREYSHROOM"},
    {43, "PUMPKIN"},
    {44, "PLANTERN"},
    {45, "TORCHWOOD"},
    {46, "SPLITPEA"},
    {47, "SEASHROOM"},
    {48, "BLOVER"},
    {49, "FLOWER_POT"},
    {50, "CACTUS"},
    {51, "DANCER"},
    {52, "TANGLEKELP"},
    {53, "STARFRUIT"},
    {54, "POLEVAULTER"},
    {55, "BALLOON"},
    {56, "GARGANTUAR"},
    {57, "IMP"},
    {58, "DIGGER"},
    {59, "DIGGER_DIRT"},
    {60, "ZOMBIE_DOLPHINRIDER"},
    {61, "POGO"},
    {62, "BACKUP_DANCER"},
    {63, "BOBSLED"},
    {64, "JACKINTHEBOX"},
    {65, "SNORKEL"},
    {66, "BUNGEE"},
    {67, "CATAPULT"},
    {68, "LADDER"},
    {69, "PUFF"},
    {70, "SLEEPING"},
    {71, "GRAVE_BUSTER"},
    {72, "ZOMBIES_WON"},
    {73, "MAGNETSHROOM"},
    {74, "BOSS"},
    {75, "CABBAGEPULT"},
    {76, "KERNELPULT"},
    {77, "MELONPULT"},
    {78, "COFFEEBEAN"},
    {79, "UMBRELLALEAF"},
    {80, "GATLINGPEA"},
    {81, "CATTAIL"},
    {82, "GLOOMSHROOM"},
    {83, "BOSS_ICEBALL"},
    {84, "BOSS_FIREBALL"},
    {85, "COBCANNON"},
    {86, "GARLIC"},
    {87, "GOLD_MAGNET"},
    {88, "WINTER_MELON"},
    {89, "TWIN_SUNFLOWER"},
    {90, "POOL_CLEANER"},
    {91, "ROOF_CLEANER"},
    {92, "FIRE_PEA"},
    {93, "IMITATER"},
    {94, "YETI"},
    {95, "BOSS_DRIVER"},
    {96, "LAWN_MOWERED_ZOMBIE"},
    {97, "CRAZY_DAVE"},
    {98, "TEXT_FADE_ON"},
    {99, "HAMMER"},
    {100, "SLOT_MACHINE_HANDLE"},
    {101, "CREDITS_FOOTBALL"},
    {102, "CREDITS_JACKBOX"},
    {103, "SELECTOR_SCREEN"},
    {104, "PORTAL_CIRCLE"},
    {105, "PORTAL_SQUARE"},
    {106, "ZENGARDEN_SPROUT"},
    {107, "ZENGARDEN_WATERINGCAN"},
    {108, "ZENGARDEN_FERTILIZER"},
    {109, "ZENGARDEN_BUGSPRAY"},
    {110, "ZENGARDEN_PHONOGRAPH"},
    {111, "DIAMOND"},
    {112, "ZOMBIE_HAND"},
    {113, "STINKY"},
    {114, "RAKE"},
    {115, "RAIN_CIRCLE"},
    {116, "RAIN_SPLASH"},
    {117, "ZOMBIE_SURPRISE"},
    {118, "COIN_GOLD"},
    {119, "TREEOFWISDOM"},
    {120, "TREEOFWISDOM_CLOUDS"},
    {121, "TREEOFWISDOM_TREEFOOD"},
    {122, "CREDITS_MAIN"},
    {123, "CREDITS_MAIN2"},
    {124, "CREDITS_MAIN3"},
    {125, "ZOMBIE_CREDITS_DANCE"},
    {126, "CREDITS_STAGE"},
    {127, "CREDITS_BIGBRAIN"},
    {128, "CREDITS_FLOWER_PETALS"},
    {129, "CREDITS_INFANTRY"},
    {130, "CREDITS_THROAT"},
    {131, "CREDITS_CRAZYDAVE"},
    {132, "CREDITS_BOSSDANCE"},
    {133, "ZOMBIE_CREDITS_SCREEN_DOOR"},
    {134, "ZOMBIE_CREDITS_CONEHEAD"},
    {135, "CREDITS_ZOMBIEARMY1"},
    {136, "CREDITS_ZOMBIEARMY2"},
    {137, "CREDITS_TOMBSTONES"},
    {138, "CREDITS_SOLARPOWER"},
    {139, "CREDITS_ANYHOUR"},
    {140, "CREDITS_WEARETHEUNDEAD"},
    {141, "CREDITS_DISCOLIGHTS"},
    {142, "FLAG"},
};

#endif //!__UTIL_H__